let e=document.createElement("style");e.innerHTML=".flex[data-v-2c3b027c]{display:flex}.flex_column[data-v-2c3b027c]{display:flex;flex-direction:column}.flexIC[data-v-2c3b027c]{align-items:center}.flexAC[data-v-2c3b027c]{align-items:center;justify-content:center}.choseFileBtn[data-v-2c3b027c]{width:30%;margin:30px 0;border-radius:4px;background:#52d4d3}.choseFileBtn img[data-v-2c3b027c]{width:40px;height:40rpx}.allBox[data-v-2c3b027c]{width:30%;position:relative;background:#fff}.fileBox[data-v-2c3b027c]{margin:40px 20px 20px;min-height:400px;border:2px dashed #d1d1d1}.sendBtn[data-v-2c3b027c]{height:40px;width:400px;border-radius:20px;line-height:40px;text-align:center;color:#fff;margin:20px}.statusBox[data-v-2c3b027c]{position:absolute;top:10px;right:-100px}.SSClass[data-v-2c3b027c]{width:100px;height:30px;line-height:30px;text-align:center;background:#3fcfce;border-radius:0 15px 15px 0;color:#fff}.SSB[data-v-2c3b027c]{background:linear-gradient(#bddee1,#f0fcfd)}.SSC[data-v-2c3b027c]{background:#52d4d3}.SSCO[data-v-2c3b027c]{color:#52d4d3}.RSClass[data-v-2c3b027c]{width:60px;height:30px;line-height:30px;text-align:center;background:#555ab2;border-radius:0 15px 15px 0;color:#fff}.RSB[data-v-2c3b027c]{background:linear-gradient(#555ab2,#a690ff)}.RSC[data-v-2c3b027c]{background:#555ab2}.RSCO[data-v-2c3b027c]{color:#555ab2}.fileItemBox[data-v-2c3b027c]{margin:5px 10px;padding:10px 5px}.fileItemBox[data-v-2c3b027c] :hover{background:#e2f6ff}",document.head.appendChild(e);import{r as l,o as a,u as i,c as t,b as s,a as d,F as n,f as c,t as o,w as r,d as p,p as u,e as f}from"./index.16495088.js";import{p as x}from"./Peer.02a2d380.js";import{j as v,_ as h,a as g,b}from"./delect.46d59f8a.js";var S={setup(){i();const e=l(0),t=l(0),s=(l([]),l([])),d=l(!0),n=(l(0),l([])),c=()=>{let e=0;for(let l of s.value)e=l.size+e;t.value=e},o=e=>{"string"==typeof e?(console.log("接收到文本消息：",e),r(e)):(console.log("接收到流数据:",e),n.value.push(e))},r=e=>{const l=JSON.parse(e);if("TransferFileStart"===l.type){s.value.find(e=>e.id==l.payload.id).status="Downloading"}else if("TransferFileEnd"===l.type){let e=s.value.find(e=>e.id==l.payload.id);e.status="Complete";const a=new Blob(n.value),i=document.createElement("a");i.href=window.URL.createObjectURL(a),i.download=e.name,i.click(),window.URL.revokeObjectURL(i.href)}else"AddFile"===l.type?s.value.push(l.payload):"DeleteFile"===l.type&&(s.value=s.value.filter(e=>e.id!=l.payload.id))};return a(async()=>{x.on("onReceiveMessage",o),v(".uploadFile").change((function(e){var l=v(".uploadFile").val();console.log(l,"上传的文件")}))}),{receiveFileList:s,isSendStatus:d,changeType:()=>{d.value=!d.value},choseFile:()=>{v(".uploadFile").click()},onDelFileItem:e=>{for(let l in s.value)if(e.id==s.value[l].id)return s.value.splice(l,1),void c()},onFileListChange:l=>{for(let a of l.target.files)a.id=e.value,a.status="noSub",s.value.push(a),e.value++;c()},downloadFile:async e=>{await x.sendJson({type:"DownloadFile",payload:{id:e}})},uid:e,filsListSize:t}}};const m=r("data-v-2c3b027c");u("data-v-2c3b027c");const y={class:"allBox flex_column"},C={class:"statusBox flex_column"},F={class:"fileBox flex flexAC"},w={key:0,class:"flex_column flexAC"},k={key:1,class:"flex_column",style:{width:"100%"}},B={class:"fileItemBox"},R={class:"flex flexIC",style:{padding:"5px 0"}},L=d("img",{src:b,style:{width:"15px"}},null,-1),O={key:0,class:"fileRemark flex",style:{width:"100%"}},_={style:{width:"100%"},class:"flex flexAC"};f();const I=m((function(e,l,a,i,r,u){return p(),t(n,null,[s(" 框 "),d("div",{class:["flex flexAC",[i.isSendStatus?"SSB":"RSB"]],style:{height:"100vh"}},[d("div",y,[s(" 状态控制器 "),d("div",C,[d("div",{class:"SSClass",onClick:l[1]||(l[1]=e=>i.changeType())},"发送端"),d("div",{class:"RSClass",onClick:l[2]||(l[2]=e=>i.changeType()),style:{"margin-top":"10px"}},"接收端")]),s(" 文件显示框 "),d("div",F,[0==i.receiveFileList.length?(p(),t("div",w,[d("input",{type:"file",multiple:"",name:"uploadFile",id:"uploadFile",class:"uploadFile",style:{visibility:"hidden",position:"absolute",top:"0px",width:"0px"},onChange:l[3]||(l[3]=e=>i.onFileListChange(e))},null,32),s(" <div @click='choseFile' class=\"choseFileBtn\">上传文件</div> "),d("img",{src:h,onClick:l[4]||(l[4]=(...e)=>i.choseFile(...e)),style:{width:"40%"}}),d("span",{class:[i.isSendStatus?"SSCO":"RSCO"]},"点击上方按钮进行上传",2)])):(p(),t("div",k,[(p(!0),t(n,null,c(i.receiveFileList,(e,l)=>(p(),t("div",B,[d("div",R,[L,d("text",{style:{"margin-left":"5px",color:"#1890ff"},onClick:l=>i.downloadFile(e.id)},o(e.name),9,["onClick"]),d("img",{style:{"margin-left":"auto",width:"15px",height:"15px"},src:g,onClick:l=>i.onDelFileItem(e)},null,8,["onClick"])])]))),256))]))]),i.receiveFileList.length>0?(p(),t("div",O,[s(" background: #555ab2 "),d("input",{type:"file",multiple:"",name:"uploadFile",id:"uploadFile",class:"uploadFile",style:{visibility:"hidden",position:"absolute",top:"0px",width:"0px"},onChange:l[5]||(l[5]=e=>i.onFileListChange(e))},null,32),d("div",{style:{"font-weight":"bold","margin-left":"20px"},class:[i.isSendStatus?"SSCO":"RSCO"],onClick:l[6]||(l[6]=(...e)=>i.choseFile(...e))},"添加文件",2),d("div",{style:{"margin-left":"auto","margin-right":"20px"},class:[i.isSendStatus?"SSCO":"RSCO"]},o(i.receiveFileList.length)+"个文件,共"+o(i.filsListSize)+"b",3)])):s("v-if",!0),d("div",_,[d("div",{class:["sendBtn",[i.isSendStatus?"SSC":"RSC"]]},"点击发送",2)])])],2)],64)}));S.render=I,S.__scopeId="data-v-2c3b027c",S.__file="src/views/Send.vue";export default S;
